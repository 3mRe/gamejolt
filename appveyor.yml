platform:
  - x86

install:
  - ps: Start-FileDownload 'https://github.com/coreybutler/nvm-windows/releases/download/1.1.1/nvm-noinstall.zip'
  - ps: Expand-Archive nvm-noinstall.zip -dest "$env:APPDATA\nvm"
  - ps: "$(\"root: $env:APPDATA\\nvm`r`npath: $env:PROGRAMFILES\\nodejs`r`narch: 32`r`nproxy: none\") | Out-File $env:APPDATA\\nvm\\settings.txt"
  - type %APPDATA%\nvm\settings.txt
  - git submodule update --init --recursive
  - choco install -y InnoSetup
  - set NVM_HOME="%APPDATA%\nvm"
  - set NVM_SYMLINK="%PROGRAMFILES%\nodejs"
  - set PATH="C:\Program Files (x86)\Inno Setup 5";%NVM_HOME%;%NVM_SYMLINK%;%PATH%
  - npm install -g gulp bower node-pre-gyp node-gyp@3.3.1

build_script:
  - bower i
  - npm i
  - npm run client-build-win

artifacts:
  - path: build\client\prod\build\Setup.exe
  - path: build\client\prod\build\win32-package.tar.gz
